# api

## Files

**Directory Stats:** 3 files, 100 lines, 544 tokens

| File | Lines | Tokens |
|------|------:|-------:|
| `__init__.py` | 6 | 27 |
| `deps.py` | 13 | 53 |
| `main.py` | 81 | 464 |

### __init__.py
*6 lines, 27 tokens*

- **Function**: `create_app` - Factory function to initialize the TurboWrap application.
- **Constant**: `app` - Main application instance exported for the server.
- **Constant**: `__all__` - Defines the public API symbols for this package.

### deps.py
*13 lines, 53 tokens*

- **Function**: `get_db` - Provides a database session dependency for API requests.

### main.py
*81 lines, 464 tokens*

- **Constant**: `TEMPLATE_DIR` - Path to the application's Jinja2 templates directory.
- **Constant**: `STATIC_DIR` - Path to the application's static assets directory.
- **Function**: `lifespan` - Manages database initialization and application lifecycle events.
- **Function**: `create_app` - Factory function that configures the FastAPI application.
- **Decorator**: `app.websocket` - Defines the WebSocket endpoint for real-time chat sessions.
- **Function**: `websocket_chat` - Handles real-time streaming chat logic via WebSockets.
- **Constant**: `app` - The primary FastAPI application instance for the server.

## Nested Directories

*Directories beyond max depth, included inline:*

### routes/ (6 files)
*API endpoint route definitions*

**__init__.py** - 16 lines
- `repos_router` (Constant)
- `tasks_router` (Constant)
- `chat_router` (Constant)
- `status_router` (Constant)
- `web_router` (Constant)

**chat.py** - 255 lines
- `router` (Constant)
- `list_sessions` (Function)
- `create_session` (Function)
- `get_session` (Function)
- `get_messages` (Function)

**repos.py** - 93 lines
- `router` (Constant)
- `list_repos` (Function)
- `clone_repo` (Function)
- `get_repo` (Function)
- `sync_repo` (Function)

**status.py** - 350 lines
- `SERVER_START_TIME` (Constant)
- `ServiceStatus` (Class)
- `FullStatus` (Class)
- `health_check` (Function)
- `agents_status` (Function)

**tasks.py** - 321 lines
- `router` (Constant)
- `run_task_background` (Function)
- `list_tasks` (Function)
- `create_task` (Function)
- `get_queue_status` (Function)

**web.py** - 138 lines
- `router` (Constant)
- `dashboard` (Function)
- `repos_page` (Function)
- `chat_page` (Function)
- `chat_session_page` (Function)

### schemas/ (4 files)
*Data validation and schemas*

**__init__.py** - 19 lines
- `RepoCreate` (Class)
- `RepoResponse` (Class)
- `RepoStatus` (Class)
- `TaskCreate` (Class)
- `TaskResponse` (Class)

**chat.py** - 89 lines
- `ChatRole` (Constant)
- `SessionStatus` (Constant)
- `ChatSessionCreate` (Class)
- `ChatSessionResponse` (Class)
- `ChatMessageCreate` (Class)

**repos.py** - 123 lines
- `RepoCreate` (Class)
- `validate_github_url` (Function)
- `RepoResponse` (Class)
- `validate_metadata` (Function)
- `model_validate` (Function)

**tasks.py** - 93 lines
- `TaskType` (Constant)
- `TaskStatusType` (Constant)
- `TaskCreate` (Class)
- `field_validator` (Decorator)
- `validate_config` (Function)

### static/ (0 files)
*Static web asset files*

### websocket/ (2 files)
*Real-time communication handlers*

**__init__.py** - 6 lines
- `ChatWebSocketHandler` (Class)
- `__all__` (Constant)

**chat_handler.py** - 153 lines
- `ChatWebSocketHandler` (Class)
- `__init__` (Function)
- `property` (Decorator)
- `claude` (Function)
- `handle` (Function)

---
*Generated by TurboWrap - 2025-12-24 15:47*