<!-- Enhanced Test Result Component -->
<div style="height: 100%; display: flex; flex-direction: column;">
    <!-- Header -->
    <div class="flex items-center justify-between px-4 py-3 bg-gradient-to-r from-amber-500 to-orange-500 text-white" style="flex-shrink: 0;">
        <div class="flex items-center gap-2">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
            </svg>
            <span class="font-semibold">Enhanced Test: {{ test_name }}</span>
        </div>
        <div class="flex items-center gap-3 text-sm">
            {% if result.original_test_count and result.new_test_count %}
            <span class="px-2 py-1 rounded bg-white/20">
                {{ result.original_test_count }} â†’ {{ result.new_test_count }} test
            </span>
            {% endif %}
        </div>
    </div>

    <!-- Summary Bar -->
    {% if result.changes_summary %}
    <div class="px-4 py-2 bg-amber-50 dark:bg-amber-900/20 border-b border-amber-200 dark:border-amber-800">
        <div class="flex flex-wrap gap-2">
            {% for change in result.changes_summary %}
            <span class="px-2 py-0.5 rounded text-xs bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-300">
                {{ change }}
            </span>
            {% endfor %}
        </div>
    </div>
    {% endif %}

    <!-- Applied Suggestions -->
    {% if result.suggestions_applied %}
    <div class="px-4 py-2 bg-green-50 dark:bg-green-900/20 border-b border-green-200 dark:border-green-800">
        <div class="flex items-center gap-2 text-xs text-green-700 dark:text-green-300">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
            </svg>
            <span class="font-medium">Suggerimenti applicati:</span>
            <span>{{ result.suggestions_applied | join(', ') }}</span>
        </div>
    </div>
    {% endif %}

    <!-- Code Content -->
    <div style="flex: 1; overflow: auto;">
        {% if result.enhanced_code %}
        <pre class="text-sm min-h-full p-0 m-0"><code class="language-{% if framework == 'pytest' %}python{% else %}typescript{% endif %}">{% set lines = result.enhanced_code.split('\n') %}{% for line in lines %}<div class="flex hover:bg-amber-50 dark:hover:bg-amber-900/10"><span class="select-none w-12 text-right pr-4 text-gray-400 border-r border-gray-200 dark:border-gray-700 flex-shrink-0 bg-gray-50 dark:bg-gray-800/50">{{ loop.index }}</span><span class="pl-4 whitespace-pre flex-1">{{ line }}</span></div>{% endfor %}</code></pre>
        {% else %}
        <div class="h-full flex items-center justify-center text-gray-400">
            <p>Nessun codice enhanced disponibile</p>
        </div>
        {% endif %}
    </div>

    <!-- Notes Footer -->
    {% if result.notes %}
    <div class="px-4 py-3 bg-gray-50 dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700" style="flex-shrink: 0;">
        <div class="flex items-start gap-2 text-sm text-gray-600 dark:text-gray-400">
            <svg class="w-4 h-4 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
            <p class="italic">{{ result.notes }}</p>
        </div>
    </div>
    {% endif %}

    <!-- Actions -->
    <div class="px-4 py-3 bg-white dark:bg-gray-900 border-t border-gray-200 dark:border-gray-700 flex justify-end gap-2" style="flex-shrink: 0;">
        <button onclick="navigator.clipboard.writeText(document.querySelector('pre code').innerText)"
                class="px-3 py-1.5 text-sm bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 rounded flex items-center gap-1.5">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
            </svg>
            Copia codice
        </button>
    </div>
</div>
